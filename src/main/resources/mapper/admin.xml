<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- id="Controller 에서 만든 List 객체 이름" -->
<mapper namespace="com.pet.sseudam.dao.AdminDao">

<!-- 진우 xml -->
    <!--일반회원정보 리스트 정렬 출력 -->
    <select id="admin_list" resultType="member">
        select (ROW_NUMBER() OVER()) as row_num, m.* from member m where identifier = 1 order by row_num desc;
    </select>

    <!--상세회원정보 가져오기 -->
    <select id="adminSelect" resultType="member">
        select *
        from member where m_id = #{m_id}
    </select>

    <!--상세회원정보(동물) 가져오기 -->
    <select id="petSelect" resultType="pet">
        select member.name
             , pet.*
        from member join pet ON member.m_id = #{m_id}
            and pet.g_id = #{m_id}
    </select>

    <!-- 회원탈퇴/복구 -->
    <update id="adminDelete" parameterType="member">
        update member set state=#{state} where m_id=#{m_id}
    </update>

<!-- 가윤 xml -->
    <!-- total 회원수 조회 작업중... -->
    <select id="getTotalMember" resultType="Integer">
        SELECT COUNT(*) FROM member where identifier = 1
    </select>

    <!-- total 상담사 조회 작업중... -->
    <select id="getTotalCounselor" resultType="Integer">
        SELECT COUNT(*) FROM member where identifier = 2
    </select>

    <!-- 반려동물-강아지 -->
    <select id="dog_list" resultType="pet">
        select g_id, p_id, animal, birth, gender, neutering from pet where kind='d'
    </select>

    <!-- 반려동물: 강아지 상세페이지 -->
    <select id="adminDogSelect" resultType="pet">
        select * from pet where p_id = #{p_id}
    </select>

    <!-- 반려동물+사람: 강아지 상세페이지 -->
    <select id="adminAnimalSelect" resultType="member">
        SELECT member.name
        FROM member
                 JOIN pet ON member.m_id = pet.g_id
        WHERE pet.p_id = #{p_id}
    </select>

    <!-- 반려동물: 고양이 -->
    <select id="cat_list" resultType="pet">
        select g_id, p_id, animal, birth, gender, neutering from pet where kind='c'
    </select>

    <!-- 반려동물: 고양이 상세페이지 -->
    <select id="adminCatSelect" resultType="pet">
        select * from pet where p_id = #{p_id}
    </select>

    <!-- 반려동물+사람: 고양이 상세페이지 -->
    <select id="adminAnimalSelect_cat" resultType="member">
        SELECT member.name
        FROM member
                 JOIN pet ON member.m_id = pet.g_id
        WHERE pet.p_id = #{p_id}
    </select>

</mapper>